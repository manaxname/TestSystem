@model TrainingProject.Web.Models.StartTestModel

@{
    ViewData["Title"] = "Start Test";


    var questionIds = Model.QuestionIds
        .Split(",")
        .Select(x => int.Parse(x));

    string currentClass = "btn btn-dark";
    int stage = 1;
}

<div id="results">
    <h4>@Model.CurrQuestionStage / @Model.StagesCount</h4>
    <form asp-action="StartTest" asp-controller="Test"
          data-ajax="true" data-ajax-method="POST"
          data-ajax-mode="replace" data-ajax-update="#results"
          data-ajax-success="success">

        @foreach (var item in questionIds)
        {
            if (stage == Model.CurrQuestionStage)
            {
                <input type="submit"
                       name="submitButton@(item)"
                       value="@(stage++)" class="btn btn-primary @currentClass" />
            }
            else
            {
                <input type="submit"
                       name="submitButton@(item)"
                       value="@(stage++)" class="btn btn-primary" />
            }
        }

        <h4>@Model.CurrQuestionText</h4>

        @foreach (var item in Model.CurrQuestionUserAnswersOptions)
        {
            <div class="form-group">
                <input data-val="true"
                       id="@item.AnswerOptionId"
                       name="@item.AnswerOptionId"
                       type="checkbox"
                       value="true" />
                <input name="@item.AnswerOptionId" type="hidden" value="false" />
                <span></span>
                @item.AnswerOption.Text
            </div>
        }

        <div class="form-group">
            <input type="hidden" asp-for="@Model.TestId" />
        </div>
        <div class="form-group">
            <input type="hidden" asp-for="@Model.StagesCount" />
        </div>
        <div class="form-group">
            <input type="hidden" asp-for="@Model.UserId" />
        </div>
        <div class="form-group">
            <input type="hidden" asp-for="@Model.CurrQuestionStage" />
        </div>

        <div class="form-group">
            <input type="hidden" asp-for="@Model.QuestionIds" />
        </div>
        <div class="form-group">
            <input type="hidden" asp-for="@Model.CurrQuestionId" />
        </div>

        <div class="form-group">
            <input type="submit" name="submitButton" value="@ViewData["SubmitButton1"]" class="btn btn-primary" />
        </div>
    </form>
</div>
